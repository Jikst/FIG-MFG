<!DOCTYPE html>
<html lang="en-US">
  <head>
  
    
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-T94X59P');</script>
    
  

  <title>
    Shell Script to Clear CloudFlare Cache | Toma Nistor - San Diego Web Developer</title>

  <meta name="title" content="Shell Script to Clear CloudFlare Cache | Toma Nistor - San Diego Web Developer">

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="referrer" content="no-referrer-when-downgrade">
  <meta name="generator" content="">
  <base href="https://tomanistor.com">

  
    <meta name="description" content="How to create a shell script in Linux that clears your website&#39;s CloudFlare cache.">
  

  
    <meta name="author" content="Toma Nistor">
  

  
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@TomaNistor">
    <meta name="twitter:creator" content="@TomaNistor">
  

  <meta property="og:title" content="Shell Script to Clear CloudFlare Cache | Toma Nistor - San Diego Web Developer">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://tomanistor.com">

  
    <meta property="og:image" content="https://tomanistor.com/images/logo/Toma-Nistor-Logo-Banner-Dark.png">
  

  
    <meta name="og:description" content="How to create a shell script in Linux that clears your website&#39;s CloudFlare cache.">
  

  
    <link rel="icon" type="image/png" sizes="16x16" href="favicon.ico">
    <meta name="theme-color" content="#FFF">
  

  <link rel="canonical" href="https://tomanistor.com/blog/shell-script-to-clear-cloudflare-cache/">

  

  <link rel="stylesheet" href="https://tomanistor.com/styles/main-bc6eebee.min.css" type="text/css">

  
    <style>nav{box-shadow:none;}</style>

  

  
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
    
  

  
    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-70206008-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

  
</head>

  <body>
    
  
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T94X59P"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  




<nav class="row middle-xs center-xs">
  <div class="col-xs-6 col-sm-1 logo">
    <a href="https://tomanistor.com#"><img src="https://tomanistor.com/images/logo/Toma-Nistor-Logo-150px.png" alt="Toma Nistor - San Diego Web Developer"></a>
  </div>
    
      <div class="col-xs-3 col-sm-2">
        <h3><a href="https://tomanistor.com/#about">About</a></h3>
      </div>
    
      <div class="col-xs-3 col-sm-2">
        <h3><a href="https://tomanistor.com/#work">Work</a></h3>
      </div>
    
      <div class="col-xs-3 col-sm-2">
        <h3><a href="https://tomanistor.com/#blog">Blog</a></h3>
      </div>
    
      <div class="col-xs-3 col-sm-2">
        <h3><a href="https://tomanistor.com/#contact">Contact</a></h3>
      </div>
    
  <div class="col-xs-6 col-sm-1 nav-toggle">
      <a href="" class="nav-icon" onclick="return false"><img src="https://tomanistor.com/images/icon-menu.png" alt="Open Menu"><img src="https://tomanistor.com/images/icon-x.png" alt="Close Menu" style="display: none;"></a>
  </div>
</nav>

<section class="nav-full row middle-xs center-xs">
  <div class="col-xs-12">
    <div class="row middle-xs center-xs">
      
        <div class="col-xs-12"><h1><a href="https://tomanistor.com/#about">About</a></h1></div>
      
        <div class="col-xs-12"><h1><a href="https://tomanistor.com/#work">Work</a></h1></div>
      
        <div class="col-xs-12"><h1><a href="https://tomanistor.com/#blog">Blog</a></h1></div>
      
        <div class="col-xs-12"><h1><a href="https://tomanistor.com/#contact">Contact</a></h1></div>
      
    </div>
  </div>
</section>

    <main>

      <section class="container">
          <section class="content">
              <h1> Shell Script to Clear CloudFlare Cache </h1>

              <div class="sub-header">
                  May 5, 2017 · 3 minute read
              </div>

              <article class="entry-content">
                  

<p><a href="https://cloudflare.com">CloudFlare</a> is a free content delivery network (CDN) that helps deliver static content quickly and efficiently throughout the world. Caching and serving static content through dependable CDNs like CloudFlare, <a href="https://maxcdn.com">MaxCDN</a>, or <a href="https://aws.amazon.com/cloudfront/">AWS CloudFront</a> can help speed up your website drastically.</p>

<blockquote>
<p>A CDN is essentially a network of geographically dispersed servers. Each CDN node (also called Edge Servers) caches the static content of a site like the images, CSS/JS files and other structural components. The majority of an end-user’s page load time is spent on retrieving this content, and so it makes sense to provide these “building blocks” of a site in as many server nodes as possible, distributed throughout the world.</p>

<p>When a user requests your site, the node closest in proximity to user will deliver the static content, ensuring the shortest distance for the data to travel (reduced latency), therefore providing the fastest site experience.</p>
</blockquote>

<p>Static resources like image, JavaScript, and CSS files that are cached by CloudFlare sometimes need to be purged before the CDN can deliver freshly updated resources. You could always log in to CloudFlare and purge the cache manually each time you make a website update, or you work smarter and create a shell script that does it for you upon deployment.</p>

<h2 id="get-your-cloudflare-global-api-key">Get Your CloudFlare Global API Key</h2>

<p>First, you must retrieve the CloudFlare <strong>Global API Key</strong>. This key will be available on your CloudFlare account settings page. Copy this key to use in the next</p>

<h2 id="get-your-cloudflare-zone-id">Get Your CloudFlare Zone ID</h2>

<p>The <strong>Zone ID</strong> can be found on your domain&rsquo;s CloudFlare overview page.</p>

<p>Another way to grab your Zone ID is to enter the following command in the terminal and replace the <code>X-Auth-Email</code> with your email and the <code>X-Auth-Key</code> with your Global API Key.</p>

<pre><code class="language-console">$ curl -X GET &quot;https://api.cloudflare.com/client/v4/zones&quot; \
-H &quot;X-Auth-Email: user@example.com&quot; \
-H &quot;X-Auth-Key: c2547eb745079dac9320b638f5e225cf483cc5cfdda42&quot; \
-H &quot;Content-Type: application/json&quot;
</code></pre>

<p>The resulting output will be a load of information about your CloudFlare account&rsquo;s domain names, including a Zone ID associated with each domain name.</p>

<h2 id="clear-your-cloudflare-cache">Clear Your CloudFlare cache</h2>

<p>We&rsquo;ll use your domain&rsquo;s Zone ID to clear the cache and force Cloudflare to fetch a fresh versions of your static files. Enter the following command in the terminal and again use your email for the <code>X-Auth-Email</code> and your Global API Key for the <code>X-Auth-Key</code>. However, now replace <code>ZONE-ID</code> with your Zone ID.</p>

<pre><code class="language-console">$ curl -X DELETE &quot;https://api.cloudflare.com/client/v4/zones/ZONE-ID/purge_cache&quot; \
-H &quot;X-Auth-Email: user@example.com&quot; \
-H &quot;X-Auth-Key: c2547eb745079dac9320b638f5e225cf483cc5cfdda42&quot; \
-H &quot;Content-Type:application/json&quot; \
--data '{&quot;purge_everything&quot;:true}'
</code></pre>

<p>If you made changes to the site they should now be visible since the cache will have been cleared.</p>

<h2 id="create-the-shell-script">Create the Shell Script</h2>

<p>Copy that last command into your text editor and add <code>#!/bin/bash</code> to the very top of the file. Feel free to add a comment under that line so you know what the bash file does in the future. At the end, I also added an <code>echo</code> to print out a message letting me know that the cache has been cleared. It should look something like this:</p>

<pre><code class="language-console">#!/bin/bash
# Clear CloudFlare cache for tomanistor.com

curl -X DELETE &quot;https://api.cloudflare.com/client/v4/zones/ZONE-ID/purge_cache&quot; \
-H &quot;X-Auth-Email: user@example.com&quot; \
-H &quot;X-Auth-Key: c2547eb745079dac9320b638f5e225cf483cc5cfdda42&quot; \
-H &quot;Content-Type:application/json&quot; \
--data '{&quot;purge_everything&quot;:true}'

echo &quot;CloudFlare cache has been cleared&quot;
</code></pre>

<p>Shell scripts should be saved in <code>usr/local/bin/</code>. I named my script <code>cloudclear</code> with no file extensions.</p>

<h2 id="run-the-script">Run the Script</h2>

<p>Type the name of your shell script in the terminal. If everything has been done correctly, the script will run and clear your CloudFlare cache.</p>

<pre><code class="language-console">$ cloudclear
</code></pre>

<p>There it is! Faster DNS cache clearing.</p>

              </article>

              <div class="pagination">
                  
                      <a href="https://tomanistor.com/blog/hugo-workflow/">&laquo; Hugo Workflow</a>
                  
                  
                      <a href="https://tomanistor.com/blog/big-list-of-free-javascript-books/">Big List of Free JavaScript Books &raquo;</a>
                  
              </div>
          </section>
          <br>
          <section class="disqus">
  <div id="disqus_thread"></div>
  <script type="text/javascript">
    (function() {
      
      
      if (window.location.hostname == "localhost")
        return;
      var disqus_shortname = 'tomanistor';
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view comments powered by <a href="http://disqus.com/?ref_noscript">Disqus</a>.</noscript>
</section>

      </section>

    </main>
    <footer class="row middle-xs center-xs">

  
  
  
    <div class="col-xs-3 col-md-2"><a target="_blank" href="https://github.com/tomanistor">GitHub</a></div>
  

  
    <div class="col-xs-3 col-md-2"><a target="_blank" href="https://linkedin.com/in/tomanistor">LinkedIn</a></div>
  

  
    <div class="col-xs-3 col-md-2"><a target="_blank" href="https://twitter.com/TomaNistor">Twitter</a></div>
  

  

</footer>

    
  
    <script src="https://tomanistor.com/scripts/highlight.pack.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>



  <script src="https://tomanistor.com/scripts/main-34fd837d.min.js" type="text/javascript"></script>


  </body>
</html>
